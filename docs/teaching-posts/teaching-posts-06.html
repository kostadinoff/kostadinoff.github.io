<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.5">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kostadin Kostadinov">
<meta name="dcterms.date" content="2024-11-11">
<meta name="description" content="Risk factors are characteristics that increase the chance of disease or adverse outcomes. Causality assessment is essential to determine whether these associations are causal. Bradford Hill’s criteria provide a systematic approach to assess causation, including strength, consistency, specificity, temporality, biological gradient, plausibility, coherence, experiment, and analogy.">

<title>Risk factors, causality. Bradford Hill’s criteria – Kostadin Kostadinov</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ff4371ef257df69894857e99c6ad0d06.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-7417df32fe97f50f0e6e4fcdc61b3192.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
<meta name="twitter:title" content="Risk factors, causality. Bradford Hill’s criteria – Kostadin Kostadinov">
<meta name="twitter:description" content="Risk factors are characteristics that increase the chance of disease or adverse outcomes. Causality assessment is essential to determine whether these associations are causal. Bradford Hill’s criteria provide a systematic approach to assess causation, including strength, consistency, specificity, temporality, biological gradient, plausibility, coherence, experiment, and analogy.">
<meta name="twitter:creator" content="@https://x.com/kostadinoffMD">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Kostadin Kostadinov</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../CV.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teaching.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kostadinoff"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/kostadinoffMD"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/kostadinovmd/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#risk-factor" id="toc-risk-factor" class="nav-link active" data-scroll-target="#risk-factor">Risk Factor</a>
  <ul class="collapse">
  <li><a href="#causality" id="toc-causality" class="nav-link" data-scroll-target="#causality">Causality</a></li>
  <li><a href="#bradford-hill-criteria" id="toc-bradford-hill-criteria" class="nav-link" data-scroll-target="#bradford-hill-criteria">Bradford Hill Criteria</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Risk factors, causality. Bradford Hill’s criteria</h1>
  <div class="quarto-categories">
    <div class="quarto-category">English</div>
    <div class="quarto-category">Public Health</div>
    <div class="quarto-category">Epidemiology</div>
    <div class="quarto-category">Medicine | 3rd year</div>
    <div class="quarto-category">Dental medicine | 5th year</div>
  </div>
  </div>

<div>
  <div class="description">
    Risk factors are characteristics that increase the chance of disease or adverse outcomes. Causality assessment is essential to determine whether these associations are causal. Bradford Hill’s criteria provide a systematic approach to assess causation, including strength, consistency, specificity, temporality, biological gradient, plausibility, coherence, experiment, and analogy.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kostadin Kostadinov </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 4, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="risk-factor" class="level1">
<h1>Risk Factor</h1>
<ol type="1">
<li><strong>Definition:</strong> Risk factor refers to characteristics or conditions that increase the likelihood of an individual or population developing a specific disease, injury, or adverse health outcome. A risk factor is an element associated with increased risk.</li>
<li>Basic definitions:
<ol type="1">
<li>Risk - The likelihood of an adverse event or disease occurrence.</li>
<li>Odds - The probability of an event happening (p) divided by the probability of the event not happening (q).</li>
</ol></li>
<li>Classification - Risk factors can be classified in several ways:
<ol type="1">
<li><em>Modifiable and Non-modifiable</em>: Modifiable risk factors are those that can be changed or managed, such as smoking, diet, or physical activity. Non-modifiable risk factors are those that cannot be changed, such as genetic characteristics.</li>
<li><em>Behavioral and Environmental Factors</em>: Behavioral risk factors are related to individual choices and actions, such as smoking, alcohol consumption, and physical activity. Environmental risk factors are associated with the surrounding environment of the individual, such as exposure to pollution, infectious agents, or workplace hazards.</li>
<li><em>Biological and Social</em>: Biological risk factors are linked to an individual’s physiology and genetics, such as hormonal imbalances or inherited traits. Social risk factors are related to the social and economic environment of the individual, such as poverty, social isolation, or lack of access to healthcare.</li>
<li><em>Proximal and Distal</em>: Proximal risk factors are those that directly contribute to the development of a particular disease or condition, such as high blood pressure or elevated blood glucose levels. Distal risk factors are those that indirectly contribute to the development of a disease or condition, such as socio-economic status or level of education.</li>
<li><em>Primary and Secondary</em>: Primary risk factors are those directly associated with the development of a specific disease or condition, such as smoking and lung cancer. Secondary risk factors are those that increase the risk of developing a disease or condition indirectly, such as obesity and its association with diabetes and heart diseases.</li>
</ol></li>
<li><strong>Exposure:</strong> The moment of contact between an individual and the risk factor. It includes the strength of the factor (power of exposure) and the duration of contact. Typically in epidemiology, individuals who have had contact with the risk factor are called exposed, while those without contact are termed unexposed.</li>
<li><strong>Risk Group:</strong> A group of the population with an increased risk of disease, sharing common risk factors.
<ol type="1">
<li>Low-risk groups: Not exposed to the influence of any known risk factor.</li>
<li>Moderate-risk groups: Exposed to moderate effects of one or several risk factors.</li>
<li>High-risk groups: Exposed to multiple risk factors over an extended period.</li>
<li>Very high-risk groups: Groups with known inherited risk factors - genetic predisposition.</li>
</ol></li>
<li><strong>Leading Risk Factors</strong>
<ol type="1">
<li>Behavioral Risk Factors:
<ol type="1">
<li>Smoking</li>
<li>High alcohol consumption</li>
<li>Low physical activity</li>
<li>Unhealthy diet</li>
</ol></li>
<li>Secondary Risk Factors:
<ol type="1">
<li>Arterial hypertension</li>
<li>Overweight</li>
<li>Hypercholesterolemia</li>
<li>Hyperglycemia</li>
</ol></li>
</ol></li>
</ol>
<section id="causality" class="level2">
<h2 class="anchored" data-anchor-id="causality">Causality</h2>
<ol type="1">
<li><strong>Definition:</strong> The concept of “causality” is fundamental to applied epidemiology. In its definition, epidemiology attempts to uncover the “causes” of diseases. In the broadest sense, a “cause” is understood as an event or phenomenon that leads to a subsequent event or phenomenon called a result. Determining the “cause” of diseases is crucial for social medicine because:
<ol type="1">
<li>It allows for the introduction of health actions preventing contact with risk factors for disease in healthy individuals (primary prevention).</li>
<li>It clarifies the mechanism of interaction between risk factors and the body and establishes the natural course of the disease.</li>
<li>It introduces specific activities for early detection of the diseased (secondary prevention).</li>
<li>It provides opportunities for in-depth research on diseases, discovery, and implementation of specific therapy and rehabilitation (tertiary prevention).</li>
</ol></li>
<li><strong>Types of Epidemiological Relationships:</strong> The concept of causality in epidemiology is quite complex. Two types of relationships are possible:
<ol type="1">
<li><em>Direct</em> - an association (correlation) between the factor and the result, with or without a true cause-effect relationship between them. When two phenomena are related but there is no cause-effect relationship, we refer to it as “<em>parallelism</em>.”</li>
<li><em>Indirect</em> - it is also possible for “<em>third</em>” or more factors to “blur” the true cause-effect relationship between phenomena or to modify (increase or decrease) the manifestation thereof.</li>
</ol></li>
<li><strong>Mechanisms:</strong> From the perspective of causality theory, a factor can cause a disease through the following mechanisms:
<ol type="1">
<li>The factor is <em>necessary and sufficient</em>. An example of such interaction is monogenic diseases. In this group of diseases, the factor represents a genetic structural anomaly that leads to a phenotypic change.</li>
<li>The factor is <em>necessary but not sufficient</em>. Many infectious diseases, for example, require additional factors besides the infectious agent. Tuberculosis bacteria are necessary for the manifestation of acute miliary tuberculosis, but they are not sufficient to cause it alone. Here, the interaction of the infectious agent with other factors in the body and the environment, which modify its effect (modifiers), is primarily important.</li>
<li>The factor is <em>not necessary but sufficient</em>. An example of such interaction is some oncological diseases. Smoking is a proven risk factor of lung cancer. Independently, it is sufficient for this disease. However, smoking is not “necessary” as an obligatory element for the onset of the disease. Other factors alone or in interaction with each other can cause the same disease in non-smokers.</li>
<li>The factor is <em>neither necessary nor sufficient</em>. These are factors that have been mistakenly considered “etiological” or “risk” factors for the onset of the disease. However, it is established that they are neither necessary nor sufficient to cause it.</li>
</ol></li>
<li><strong>Types of Interactions between Factor (Cause) and Result:</strong> Despite the various types of interactions between different factors in the genesis of the disease, from an epidemiological point of view, three types of interfactor interactions can be presented schematically and simplified.
<ol type="1">
<li><strong>Chain Interaction: Mediator/Modifier Type:</strong> In this form of interaction, a single risk factor alone is potent enough to incite a particular ailment. However, the involvement of a third factor, often termed a “mediator,” intercedes in the connection between the risk factor and the disease manifestation. For instance, the relationship between smoking and cerebrovascular disease - while smoking can directly lead to cerebrovascular issues, it can also induce arterial hypertension, which subsequently increases the risk of cerebrovascular disease. Moreover, within this model, there’s discussion about modifying interactions, where an additional factor alters the impact of the risk factor, either attenuating or amplifying it. Such alterations may exhibit:</li>
<li><em>Multiplicative</em> effects (significantly stronger when combined).</li>
<li><em>Additive</em> effects (the combined influence of the modifier and the risk factor).</li>
</ol></li>
<li><strong>Divergent Interaction: Confounding Factor Type:</strong> This scenario involves a factor that acts as a common underlying cause for both the risk factor and the disease outcome. In clinical epidemiology, common confounding factors include gender and age. Despite being often categorized as “<em>risk</em>” factors, gender and age should more accurately be labeled as “<em>prognostic</em>”, rather than direct <em>causes</em> of diseases. For example, when exploring the link between coffee consumption and myocardial infarction, while coffee intake might be perceived as a direct risk factor, upon separate examination within smoker and non-smoker groups, the link disappear. Here, coffee consumption acts as a confounding factor, while the actual cause-effect relationship lies between smoking and heart attacks. The process of segregating individuals based on such factors is known as “stratification.”</li>
<li><strong>Cumulative Interaction (Collier):</strong> This type involves a factor that emerges as a shared outcome of both the risk factor and the disease itself. For instance, a study conducted by Sackett in 1979, where an analysis of hospitalized patients found a correlation between locomotor deficits and infectious lung diseases. Initially appearing as a plausible association, later scrutiny in a sample of non-hospitalized individuals failed to establish such a relationship. This discrepancy underscores the nuanced nature of disease interactions, wherein seemingly related conditions might, upon closer examination, reveal independent pathways to the same outcome, such as hospitalization.</li>
</ol>
</section>
<section id="bradford-hill-criteria" class="level2">
<h2 class="anchored" data-anchor-id="bradford-hill-criteria">Bradford Hill Criteria</h2>
<ol type="1">
<li><strong>Definition:</strong> Bradford-Hill endeavors to introduce criteria that should be met to determine a causal relationship between two factors. His work remains foundational in epidemiology and causality theory.</li>
<li><strong>Criteria:</strong>
<ol type="1">
<li><em>Strength of Association:</em> The stronger the statistical association between phenomena, the more likely the relationship between them is causal.</li>
<li><em>Consistency (Reproducibility):</em> The findings should be reproducible by other researchers, at different times, in different places, and using different methods, with explanations for any discrepancies.</li>
<li><em>Specificity of Association:</em> The more precisely the disease and exposure to the presumed risk factor can be defined, the stronger the observed association.</li>
<li><em>Temporal Relationship:</em> The presumed cause must always precede the effect in time. This is the only obligatory criterion.</li>
<li><em>Biological Gradient:</em> Changes in the intensity of exposure to the presumed risk factor lead to corresponding changes in the level of disease occurrence.</li>
<li><em>Plausibility:</em> The association must have a logical explanation in line with general medical knowledge and science.</li>
<li><em>Coherence:</em> All observations and results should be consistent with the hypothetical model.</li>
<li><em>Experimental Evidence:</em> In experimental conditions, changes in the cause should lead to changes in the outcome.</li>
<li><em>Analogy:</em> The association should resemble similar described phenomena and events.</li>
</ol></li>
<li><strong>Mandatory Criterion:</strong> Temporal relationship</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Email me at kostadinr.kostadinov@mu-plovdiv.bg</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>